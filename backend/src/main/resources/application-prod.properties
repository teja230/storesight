# Production Profile Configuration
# This profile is used for production environment

# CORS Configuration for Production
# Strict CORS policy for production domains
cors.allowed-origins=https://www.shopgaugeai.com,https://shopgaugeai.com

# Security Configuration for Production
security.rate-limit.enabled=true
security.rate-limit.requests-per-minute=60
security.debug-endpoints.enabled=false

# Production-specific settings
logging.level.com.storesight=WARN
logging.level.org.springframework.web=WARN
logging.level.org.springframework.security=WARN

# Production frontend URL
frontend.url=https://www.shopgaugeai.com

# Production Shopify redirect URI
shopify.redirect_uri=https://api.shopgaugeai.com/api/auth/shopify/callback

# Production Database Connection Pool Configuration - OPTIMIZED FOR SCALABILITY
# CRITICAL: Enable custom database configuration for production
storesight.database.custom-config.enabled=true

# Optimized HikariCP settings for remote PostgreSQL database
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.maximum-pool-size=${DB_POOL_SIZE:15}
spring.datasource.hikari.minimum-idle=${DB_MIN_IDLE:3}
spring.datasource.hikari.idle-timeout=180000
spring.datasource.hikari.max-lifetime=900000
spring.datasource.hikari.leak-detection-threshold=30000
spring.datasource.hikari.validation-timeout=3000
spring.datasource.hikari.pool-name=StoresightHikariCP-Prod
spring.datasource.hikari.register-mbeans=true

# Critical production settings for connection reliability
spring.datasource.hikari.allow-pool-suspension=false
spring.datasource.hikari.initialization-fail-timeout=10000
spring.datasource.hikari.keepalive-time=300000

# PostgreSQL connection properties for better reliability
spring.datasource.hikari.data-source-properties.autoReconnect=true
spring.datasource.hikari.data-source-properties.maxReconnects=2
spring.datasource.hikari.data-source-properties.socketTimeout=20000
spring.datasource.hikari.data-source-properties.connectTimeout=15000
spring.datasource.hikari.data-source-properties.tcpKeepAlive=true
spring.datasource.hikari.data-source-properties.loginTimeout=10

# Production Redis Configuration - Enhanced timeouts and reliability
spring.data.redis.timeout=8s
spring.data.redis.lettuce.pool.max-active=6
spring.data.redis.lettuce.pool.max-idle=6
spring.data.redis.lettuce.pool.min-idle=2
spring.data.redis.lettuce.pool.max-wait=2s

# Production Session Configuration - Aligned with business app standards
spring.session.timeout=4h
spring.session.redis.namespace=storesight:prod:sessions
spring.session.redis.flush-mode=on-save

# Transaction timeouts for production stability - CRITICAL FOR SCALABILITY
spring.transaction.default-timeout=15s
spring.jpa.properties.hibernate.connection.autocommit=true
spring.jpa.properties.hibernate.connection.provider_disables_autocommit=false

# JPA Configuration for better performance
spring.jpa.properties.hibernate.jdbc.batch_size=15
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true
spring.jpa.properties.hibernate.jdbc.batch_versioned_data=true
spring.jpa.properties.hibernate.connection.release_mode=after_transaction

# Disable debug endpoints for production
management.endpoints.enabled-by-default=false
management.endpoints.web.exposure.include=health,info,metrics 